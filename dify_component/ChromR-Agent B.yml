app:
  description: æœºå™¨äººå¯ä»¥æ ¹æ®ç»™å®šçš„åˆå§‹æŸ±å±‚æå·¥è‰ºå‚æ•°è¿›è¡Œå®éªŒè®¾è®¡ã€‚å®éªŒè®¾è®¡ç®—æ³•åº”è¯¥åŒ…æ‹¬ä¸»åŠ¨å­¦ä¹ å¦‚è´å¶æ–¯ä¼˜åŒ–ã€å¼ºåŒ–å­¦ä¹ ï¼Œå’Œä¼ ç»Ÿå®éªŒè®¾è®¡å¦‚DSDã€PBç­‰ã€‚æ³¨ï¼šä¸»åŠ¨å­¦ä¹ ä¸»è¦ç”¨äºå‚æ•°å¾ˆå¤šï¼Œå‡è®¾ç©ºé—´å¾ˆå¤§çš„åœºæ™¯ï¼Œä»¥é“¶æå¶æå–ç‰©ä¸ºä¾‹å­æ—¶å¯æš‚æ—¶ä¸è€ƒè™‘ã€‚
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: workflow
  name: ChromR-Agent B
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/tongyi:0.0.54@a719a5a226596151af6ff33fa710a74476faa6e1afde9e4a201ff8a7803857ff
kind: app
version: 0.3.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInLoop: false
        sourceType: parameter-extractor
        targetType: if-else
      id: 1744337758034-source-1744337710452-target
      selected: false
      source: '1744337758034'
      sourceHandle: source
      target: '1744337710452'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: parameter-extractor
        targetType: parameter-extractor
      id: 1744372089111-source-1744337758034-target
      selected: false
      source: '1744372089111'
      sourceHandle: source
      target: '1744337758034'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: if-else
      id: 1744278097895-source-1744373398619-target
      selected: false
      source: '1744278097895'
      sourceHandle: source
      target: '1744373398619'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: code
      id: 1744373398619-true-1744376522033-target
      selected: false
      source: '1744373398619'
      sourceHandle: 'true'
      target: '1744376522033'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: code
      id: 1744337710452-true-1744278097895-target
      selected: false
      source: '1744337710452'
      sourceHandle: 'true'
      target: '1744278097895'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: code
      id: 1744337710452-false-17443556537560-target
      selected: false
      source: '1744337710452'
      sourceHandle: 'false'
      target: '17443556537560'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: variable-aggregator
      id: 1744376522033-source-1744364078889-target
      selected: false
      source: '1744376522033'
      sourceHandle: source
      target: '1744364078889'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: variable-aggregator
      id: 1744373398619-false-1744364078889-target
      selected: false
      source: '1744373398619'
      sourceHandle: 'false'
      target: '1744364078889'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: variable-aggregator
      id: 17443556537560-source-1744364078889-target
      selected: false
      source: '17443556537560'
      sourceHandle: source
      target: '1744364078889'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: start
        targetType: parameter-extractor
      id: 1744273691090-source-1756553929651-target
      selected: false
      source: '1744273691090'
      sourceHandle: source
      target: '1756553929651'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: parameter-extractor
        targetType: parameter-extractor
      id: 1756553929651-source-1744372089111-target
      selected: false
      source: '1756553929651'
      sourceHandle: source
      target: '1744372089111'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: variable-aggregator
        targetType: code
      id: 1744364078889-source-1756556854361-target
      selected: false
      source: '1744364078889'
      sourceHandle: source
      target: '1756556854361'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: end
      id: 1756556854361-source-1744364099175-target
      selected: false
      source: '1756556854361'
      sourceHandle: source
      target: '1744364099175'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: å¼€å§‹
        type: start
        variables:
        - label: å®éªŒè®¾è®¡æè¿°
          max_length: 1024
          options: []
          required: true
          type: paragraph
          variable: exp_description
      height: 90
      id: '1744273691090'
      position:
        x: 30
        y: 276.5
      positionAbsolute:
        x: 30
        y: 276.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import definitive_screening_design as dsd\nimport ast\nimport warnings\n\
          import pandas as pd\n\n# å¿½ç•¥æ‰€æœ‰è­¦å‘Š\nwarnings.filterwarnings(\"ignore\")\n\n\
          def main(exp: str, factors: str, extra_para: str) -> dict:\n    # å°†è¾“å…¥å­—ç¬¦ä¸²è§£æä¸ºå­—å…¸\n\
          \    factors_dict = ast.literal_eval(factors)\n    extra_para_dict = ast.literal_eval(extra_para)\n\
          \    \n    # ç”ŸæˆDSDè®¾è®¡\n    result_df = dsd.generate(factors_dict=factors_dict,\
          \ n_fake_factors=2 if extra_para_dict == {} else extra_para_dict['n_fake_factors'])\n\
          \    \n    result = {\n        \"result\": result_df.to_string(),\n    \
          \    \"factors_dict\": factors_dict,\n        \"dsd_result\": result_df.to_dict()\n\
          \    }\n    \n    return result"
        code_language: python3
        default_value:
        - key: result
          type: string
          value: æ— æ³•ç”Ÿæˆå®éªŒè®¾è®¡è¡¨
        - key: factors_dict
          type: object
          value: '{}'
        - key: dsd_result
          type: object
          value: '{}'
        desc: ''
        error_strategy: default-value
        outputs:
          dsd_result:
            children: null
            type: object
          factors_dict:
            children: null
            type: object
          result:
            children: null
            type: string
        selected: false
        title: DSDå®éªŒè®¾è®¡
        type: code
        variables:
        - value_selector:
          - '1744337758034'
          - exp
          variable: exp
        - value_selector:
          - '1744337758034'
          - factors
          variable: factors
        - value_selector:
          - '1744337758034'
          - extra_para
          variable: extra_para
      height: 90
      id: '1744278097895'
      position:
        x: 1541.2237608124813
        y: 276.5
      positionAbsolute:
        x: 1541.2237608124813
        y: 276.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: is
            id: 767090c5-dfad-4132-9073-557e3569cccc
            value: Definitive Screening Design
            varType: string
            variable_selector:
            - '1744337758034'
            - exp
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: DSDå®éªŒåˆ¤æ–­
        type: if-else
      height: 126
      id: '1744337710452'
      position:
        x: 1239
        y: 276.5
      positionAbsolute:
        x: 1239
        y: 276.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ä»ç”¨æˆ·ç»™å®šçš„å®éªŒè®¾è®¡æè¿°ä¸­æå–å…³é”®å‚æ•°
        instruction: "ä»ç”¨æˆ·ç»™å®šçš„å®éªŒè®¾è®¡æè¿°ä¸­æå–å®éªŒåç§°ã€å®éªŒè®¾è®¡å¯èƒ½å­˜åœ¨çš„é¢å¤–å‚æ•°å’Œå› å­æ°´å¹³ã€‚\n**æ³¨æ„**ï¼šé™¤äº†Box-Behnkenå’ŒFull\
          \ factorialå®éªŒè®¾è®¡å¤–ï¼Œå…¶ä»–å®éªŒè®¾è®¡çš„factorsåªéœ€è¦æä¾›èŒƒå›´çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼Œå¦‚[-1,0,1]æå–ä¸º[-1,1]\n\nå¯é€‰çš„å®éªŒåç§°ã€é¢å¤–çš„å‚æ•°åŠå› å­æ°´å¹³ç¤ºä¾‹å¦‚ä¸‹ï¼š\n\
          ## Full factorialï¼š\nextra_paraç¤ºä¾‹ï¼š'{}'\nfactorsç¤ºä¾‹:{'å‹åŠ›':[50,60,70],'æ¸©åº¦':[290,\
          \ 320, 350],'æµé‡':[0.9,1.0]}\n\n## 2-level fractional factorialï¼š\né¢å¤–å‚æ•°: æ‰€éœ€è®¾è®¡åˆ†è¾¨ç‡\n\
          extra_paraç¤ºä¾‹ï¼š{'res':3}\nå› å­ï¼šä»…éœ€è¦èŒƒå›´çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚å¦‚æœæä¾›è¶…è¿‡ä¸¤ä¸ªæ°´å¹³ï¼Œåˆ™å–æå€¼ä½œä¸ºä½/é«˜æ°´å¹³ã€‚\nfactorsç¤ºä¾‹:{'å‹åŠ›':[50,70],'æ¸©åº¦':[290,\
          \ 350],'æµé‡':[0.9,1.0]}\n\n## Plackett-Burmanï¼š\nextra_paraç¤ºä¾‹ï¼š'{}'\nå› å­ï¼šä»…éœ€è¦èŒƒå›´çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚\n\
          factorsç¤ºä¾‹:{'å‹åŠ›':[50,70],'æ¸©åº¦':[290, 350],'æµé‡':[0.9,1.0]}\n\n## Sukharev gridï¼š\n\
          é¢å¤–å‚æ•°ï¼šæ ·æœ¬æ•°å¿…é¡»æ»¡è¶³ï¼šæ ·æœ¬æ•°çš„(1/ç»´åº¦)æ¬¡æ–¹ä¸ºæ•´æ•°ï¼ˆå…¶ä¸­ç»´åº¦æ˜¯å˜é‡æ•°é‡ï¼‰ã€‚num_samples: éœ€ç”Ÿæˆçš„æ ·æœ¬æ•°\nextra_paraç¤ºä¾‹ï¼š{'num_samples':10}\n\
          å› å­ï¼šä»…éœ€è¦èŒƒå›´çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚\nfactorsç¤ºä¾‹:{'å‹åŠ›':[50,70],'æ¸©åº¦':[290, 350],'æµé‡':[0.9,1.0]}\n\
          \n## Box-Behnkenï¼š\né¢å¤–å‚æ•°ï¼šcenterï¼šä¸­å¿ƒç‚¹æ•°\nextra_paraç¤ºä¾‹ï¼š{'center':1}\nå› å­ï¼šæ³¨æ„ï¼šå› å­éœ€è¦3ä¸ªæ°´å¹³ã€‚å¦‚æœªæä¾›ï¼Œå‡½æ•°å°†è‡ªåŠ¨é€šè¿‡çº¿æ€§ä¸­åˆ†æ³•åˆ›å»º3æ°´å¹³ã€‚\n\
          factorsç¤ºä¾‹:{'å‹åŠ›':[50,60,70],'æ¸©åº¦':[290, 320, 350],'æµé‡':[0.9,1.0,1.1]}\n\n\
          ## Box-Wilson (Central-composite) with center-faced option, Box-Wilson (Central-composite)\
          \ with center-inscribed option, Box-Wilson (Central-composite) with center-circumscribed\
          \ optionï¼š\nè‹¥æœªæŒ‡å®šï¼Œåˆ™é»˜è®¤é€‰æ‹©Box-Wilson (Central-composite) with center-circumscribed\
          \ option\né¢å¤–å‚æ•°ï¼š\n- center : intæ•°ç»„ï¼Œ1x2æ•´æ•°æ•°ç»„ï¼Œè¡¨ç¤ºè®¾è®¡å„åŒºå—çš„ä¸­å¿ƒç‚¹æ•°é‡ã€‚å½¢å¦‚(n1, n2)ï¼Œn1ä¸º\"\
          ç«‹æ–¹ä½“å†…\"åŒºå—ä¸­å¿ƒç‚¹æ•°ï¼Œn2ä¸º\"ç«‹æ–¹ä½“å¤–\"åŒºå—ä¸­å¿ƒç‚¹æ•°\nextra_paraç¤ºä¾‹ï¼š{'center':(2,2)}\nå› å­ï¼šä»…éœ€è¦èŒƒå›´çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚\n\
          factorsç¤ºä¾‹:{'å‹åŠ›':[50,70],'æ¸©åº¦':[290, 350],'æµé‡':[0.9,1.0]}\n\n## Latin hypercube\
          \ (simple)ï¼š\né¢å¤–å‚æ•°ï¼š    \n- num_samples: éœ€ç”Ÿæˆçš„æ ·æœ¬æ•°\n- prob_distribution: éšæœºæŠ½æ ·åº”ç”¨çš„è§£ææ¦‚ç‡åˆ†å¸ƒã€‚å¯é€‰å€¼:\
          \ 'Normal', 'Poisson', 'Exponential', 'Beta', 'Gamma'ã€‚é»˜è®¤:None\nextra_paraç¤ºä¾‹ï¼š{'num_samples':5,'prob_distribution':'Normal'}\n\
          å› å­ï¼šä»…éœ€è¦èŒƒå›´çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚\nfactorsç¤ºä¾‹:{'å‹åŠ›':[50,70],'æ¸©åº¦':[290, 350],'æµé‡':[0.9,1.0]}\n\
          \n## Latin hypercube (space-filling), Random k-means cluster, Maximin reconstruction,\
          \ Halton sequence based, Uniform random matrixï¼š\né¢å¤–å‚æ•°ï¼š    \n- num_samples:\
          \ éœ€ç”Ÿæˆçš„æ ·æœ¬æ•°\nextra_paraç¤ºä¾‹ï¼š{'num_samples':5}\nå› å­ï¼šä»…éœ€è¦èŒƒå›´çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚\nfactorsç¤ºä¾‹:{'å‹åŠ›':[50,70],'æ¸©åº¦':[290,\
          \ 350],'æµé‡':[0.9,1.0]}\n\n## Definitive Screening Designï¼š\né¢å¤–å‚æ•°ï¼š\n- n_fake_factors\
          \ (int)ï¼šåŒ…å«æ•°å€¼å‹ä¼ªå› å­ä»¥å¢åŠ è¯•éªŒæ¬¡æ•°ï¼Œæ‰©å¤§è®¾è®¡è§„æ¨¡\nextra_paraç¤ºä¾‹ï¼š{'n_fake_factors':2}\nå› å­ï¼šä»…éœ€è¦èŒƒå›´çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚æ³¨æ„ï¼šç®—æ³•é€šè¿‡æ•°æ®ç±»å‹æ¨æ–­æ•°å€¼å‹/åˆ†ç±»å‹å› å­ï¼šå¦‚éœ€åˆ†ç±»æ°´å¹³ï¼Œè¯·ä½¿ç”¨å­—ç¬¦ä¸²æ•°å­—å¦‚(\"\
          1\", \"2\")\nfactorsç¤ºä¾‹:{ 'æ¸©åº¦': [30, 90], 'Solvent': [\"A\", \"B\"]}"
        model:
          completion_params:
            seed: 1234
          mode: chat
          name: qwen2.5-32b-instruct
          provider: langgenius/tongyi/tongyi
        parameters:
        - description: å®éªŒåç§°
          name: exp
          required: true
          type: string
        - description: å®éªŒå› å­åŠæ°´å¹³ï¼Œå­—å…¸æ ¼å¼
          name: factors
          required: true
          type: string
        - description: å®éªŒè®¾è®¡æ‰€éœ€çš„é¢å¤–å‚æ•°ï¼Œå­—å…¸æ ¼å¼ï¼Œæ²¡æœ‰åˆ™ä¸ºç©ºå­—å…¸
          name: extra_para
          required: true
          type: string
        query:
        - '1744372089111'
        - fine_exp_description
        reasoning_mode: prompt
        selected: false
        title: å®éªŒè®¾è®¡å‚æ•°æå–å™¨
        type: parameter-extractor
        variables: []
        vision:
          enabled: false
      height: 134
      id: '1744337758034'
      position:
        x: 934.1665344320533
        y: 276.5
      positionAbsolute:
        x: 934.1665344320533
        y: 276.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "from doepy3 import build\nimport ast\nimport warnings\nwarnings.filterwarnings(\"\
          ignore\")\n\ndef main(exp: str, factors: str, extra_para: str) -> dict:\n\
          \    factors_dict = ast.literal_eval(factors)\n    extra_para_dict = ast.literal_eval(extra_para)\n\
          \n    if exp == \"Full factorial\":\n        # å¤„ç†å…¨å› å­è®¾è®¡\n        result =\
          \ build.full_fact(factors_dict)\n\n    elif exp == \"2-level fractional\
          \ factorial\":\n        # å¤„ç†äºŒæ°´å¹³éƒ¨åˆ†å› å­è®¾è®¡\n        res = extra_para_dict['res']\
          \ if extra_para_dict != {} else None\n        result = build.frac_fact_res(factors_dict,\
          \ res=res)\n\n    elif exp == \"Plackett-Burman\":\n        # å¤„ç†Plackett-Burmanè®¾è®¡\n\
          \        result = build.plackett_burman(factors_dict)\n\n    elif exp ==\
          \ \"Sukharev grid\":\n        # å¤„ç†Sukharevç½‘æ ¼è®¾è®¡\n        num_samples = extra_para_dict['num_samples']\
          \ if extra_para_dict != {} else None\n        result = build.sukharev(factors_dict,\
          \ num_samples=num_samples)\n\n    elif exp == \"Box-Behnken\":\n       \
          \ # å¤„ç†Box-Behnkenè®¾è®¡\n        center = extra_para_dict['center'] if extra_para_dict\
          \ != {} else 1\n        result = build.box_behnken(factors_dict, center=center)\n\
          \n    elif exp == \"Box-Wilson (Central-composite) with center-faced option\"\
          :\n        # å¤„ç†å¸¦æœ‰ä¸­å¿ƒé¢å¯¹é€‰é¡¹çš„Box-Wilsonï¼ˆä¸­å¿ƒå¤åˆï¼‰è®¾è®¡\n        center = extra_para_dict['center']\
          \ if extra_para_dict != {} else (2, 2)\n        result = build.central_composite(factors_dict,\
          \ center=center, face='ccf')\n\n    elif exp == \"Box-Wilson (Central-composite)\
          \ with center-inscribed option\":\n        # å¤„ç†å¸¦æœ‰ä¸­å¿ƒå†…åˆ‡é€‰é¡¹çš„Box-Wilsonï¼ˆä¸­å¿ƒå¤åˆï¼‰è®¾è®¡\n\
          \        center = extra_para_dict['center'] if extra_para_dict != {} else\
          \ (2, 2)\n        result = build.central_composite(factors_dict, center=center,\
          \ face='cci')\n\n    elif exp == \"Box-Wilson (Central-composite) with center-circumscribed\
          \ option\":\n        # å¤„ç†å¸¦æœ‰ä¸­å¿ƒå¤–æ¥é€‰é¡¹çš„Box-Wilsonï¼ˆä¸­å¿ƒå¤åˆï¼‰è®¾è®¡\n        center = extra_para_dict['center']\
          \ if extra_para_dict != {} else (2, 2)\n        result = build.central_composite(factors_dict,\
          \ center=center, face='ccc')\n\n    elif exp == \"Latin hypercube (simple)\"\
          :\n        # å¤„ç†ç®€å•æ‹‰ä¸è¶…ç«‹æ–¹è®¾è®¡\n        num_samples = extra_para_dict['num_samples']\
          \ if extra_para_dict != {} else None\n        prob_distribution = extra_para_dict['prob_distribution']\
          \ if extra_para_dict != {} else None\n        result = build.lhs(factors_dict,\
          \ num_samples=num_samples, prob_distribution=prob_distribution)\n\n    elif\
          \ exp == \"Latin hypercube (space-filling)\":\n        # å¤„ç†ç©ºé—´å¡«å……æ‹‰ä¸è¶…ç«‹æ–¹è®¾è®¡\n\
          \        num_samples = extra_para_dict['num_samples'] if extra_para_dict\
          \ != {} else None\n        result = build.space_filling_lhs(factors_dict,\
          \ num_samples=num_samples)\n\n    elif exp == \"Random k-means cluster\"\
          :\n        # å¤„ç†éšæœºk-meansèšç±»\n        num_samples = extra_para_dict['num_samples']\
          \ if extra_para_dict != {} else None\n        result = build.random_k_means(factors_dict,\
          \ num_samples=num_samples)\n\n    elif exp == \"Maximin reconstruction\"\
          :\n        # å¤„ç†æœ€å¤§æœ€å°é‡æ„\n        num_samples = extra_para_dict['num_samples']\
          \ if extra_para_dict != {} else None\n        result = build.maximin(factors_dict,\
          \ num_samples=num_samples)\n\n    elif exp == \"Halton sequence based\"\
          :\n        # å¤„ç†åŸºäºHaltonåºåˆ—çš„è®¾è®¡\n        num_samples = extra_para_dict['num_samples']\
          \ if extra_para_dict != {} else None\n        result = build.halton(factors_dict,\
          \ num_samples=num_samples)\n\n    elif exp == \"Uniform random matrix\"\
          :\n        # å¤„ç†å‡åŒ€éšæœºçŸ©é˜µ\n        num_samples = extra_para_dict['num_samples']\
          \ if extra_para_dict != {} else None\n        result = build.uniform_random(factors_dict,\
          \ num_samples=num_samples)\n\n    else:\n        # å¤„ç†æœªçŸ¥çš„å®éªŒè®¾è®¡åç§°\n       \
          \ result = 'æœªçŸ¥å®éªŒè®¾è®¡æ–¹æ³•'\n\n    result.index = result.index + 1\n    return\
          \ {\n        \"result\": result.to_string(),\n        \"exp_count\": len(result)\n\
          \    }"
        code_language: python3
        default_value:
        - key: result
          type: string
          value: æ— æ³•ç”Ÿæˆå®éªŒè®¾è®¡
        - key: exp_count
          type: number
          value: 0
        desc: ''
        error_strategy: default-value
        outputs:
          exp_count:
            children: null
            type: number
          result:
            children: null
            type: string
        selected: false
        title: å…¶ä»–å®éªŒè®¾è®¡
        type: code
        variables:
        - value_selector:
          - '1744337758034'
          - exp
          variable: exp
        - value_selector:
          - '1744337758034'
          - factors
          variable: factors
        - value_selector:
          - '1744337758034'
          - extra_para
          variable: extra_para
      height: 90
      id: '17443556537560'
      position:
        x: 2148
        y: 425.5
      positionAbsolute:
        x: 2148
        y: 425.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        advanced_settings:
          group_enabled: false
          groups: []
        desc: ''
        output_type: string
        selected: false
        title: å˜é‡èšåˆå™¨
        type: variable-aggregator
        variables:
        - - '17443556537560'
          - result
        - - '1744376522033'
          - result
        - - '1744278097895'
          - result
      height: 152
      id: '1744364078889'
      position:
        x: 2451
        y: 351
      positionAbsolute:
        x: 2451
        y: 351
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1756556854361'
          - result
          value_type: string
          variable: result
        selected: false
        title: ç»“æŸ
        type: end
      height: 90
      id: '1744364099175'
      position:
        x: 3211.1719894965754
        y: 351
      positionAbsolute:
        x: 3211.1719894965754
        y: 351
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: å¦‚æœç”¨æˆ·åªæä¾›å› å­æ•°ï¼Œåˆ™è‡ªåŠ¨å®Œå–„è¡¥å…¨
        instruction: 'åˆ¤æ–­ç”¨æˆ·å®éªŒæè¿°ï¼Œæ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªä»»åŠ¡æ¡ä»¶åˆ™ä¿®æ”¹ï¼Œå¦åˆ™ä¸ä¿®æ”¹ï¼Œè¿”å›çš„æè¿°èµ‹å€¼ç»™fine_exp_description


          # ä»»åŠ¡ä¸€

          åˆ¤æ–­ç”¨æˆ·æä¾›çš„å®éªŒæè¿°ä¸­çš„å› å­æ˜¯å¦æä¾›äº†å…·ä½“åå­—å’ŒèŒƒå›´ï¼Œå¦‚æœå› å­æ²¡æœ‰åç§°åˆ™ä½¿ç”¨X1-XnæŒ‡ä»£ï¼Œè‹¥å› å­æ²¡æœ‰æ°´å¹³å…·ä½“æ•°å€¼åˆ™ç”¨-1,0,1ç­‰æ•´æ•°æ¥æŒ‡ä»£ã€‚


          ## ç¤ºä¾‹ä¸€

          - ç”¨æˆ·æä¾›ï¼šâ€œç”Ÿæˆå››å› å­ä¸‰æ°´å¹³çš„DSDå®éªŒè®¾è®¡ï¼Œè™šæ‹Ÿå› å­ä¸º2ï¼Œå‚æ•°åˆ†åˆ«ä¸ºæ¸©åº¦ã€æ—¶é—´ã€æ–™æ³¢æ¯”ã€æµ“åº¦â€

          - å®Œå–„åï¼šâ€œç”Ÿæˆå››å› å­ä¸‰æ°´å¹³çš„DSDå®éªŒè®¾è®¡ï¼Œè™šæ‹Ÿå› å­ä¸º2ï¼Œå‚æ•°åˆ†åˆ«ä¸ºæ¸©åº¦[-1ï¼Œ0ï¼Œ1]ã€æ—¶é—´[-1ï¼Œ0ï¼Œ1]ã€æ–™æ³¢æ¯”[-1ï¼Œ0ï¼Œ1]ã€æµ“åº¦[-1ï¼Œ0ï¼Œ1]â€


          ## ç¤ºä¾‹äºŒ

          - ç”¨æˆ·æä¾›ï¼šâ€œç”Ÿæˆå››å› å­ä¸‰æ°´å¹³çš„DSDå®éªŒè®¾è®¡ï¼Œè™šæ‹Ÿå› å­ä¸º2â€

          - å®Œå–„åï¼šâ€œç”Ÿæˆå››å› å­ä¸‰æ°´å¹³çš„DSDå®éªŒè®¾è®¡ï¼Œè™šæ‹Ÿå› å­ä¸º2ä¸ªã€‚å› å­ï¼šX1[-1ï¼Œ0ï¼Œ1]ï¼ŒX2[-1ï¼Œ0ï¼Œ1]ï¼ŒX3[-1ï¼Œ0ï¼Œ1]ï¼ŒX4[-1ï¼Œ0ï¼Œ1]â€


          # ä»»åŠ¡äºŒ

          åˆ¤æ–­ç”¨æˆ·æè¿°ä¸­æ˜¯å¦å…·ä½“è¯´æ˜äº†ä½¿ç”¨å“ªç§å®éªŒè®¾è®¡ï¼Œè‹¥æ²¡æœ‰åˆ™é»˜è®¤ä½¿ç”¨DSDå®éªŒè®¾è®¡ã€‚

          ## ç¤ºä¾‹ä¸€

          - ç”¨æˆ·æä¾›ï¼šâ€œç”Ÿæˆå››å› å­ä¸¤æ°´å¹³çš„å®éªŒè®¾è®¡â€

          - å®Œå–„åï¼šâ€œç”Ÿæˆå››å› å­ä¸¤æ°´å¹³çš„DSDå®éªŒè®¾è®¡ã€‚å› å­ï¼šX1[-1ï¼Œ1]ï¼ŒX2[-1ï¼Œ1]ï¼ŒX3[-1ï¼Œ1]ï¼ŒX4[-1ï¼Œ1]â€


          # ä»»åŠ¡ä¸‰

          åˆ¤æ–­ç”¨æˆ·æä¾›çš„å®éªŒæè¿°æ˜¯å¦ä½¿ç”¨äº†ç¡®å®šæ€§ç­›é€‰å®éªŒè®¾è®¡ï¼ˆDSDï¼‰ï¼Œä¸”è¦æ±‚å¢åŠ ä¸­å¿ƒç‚¹ã€‚å¦‚æœæ˜¯DSDï¼Œä¸”è¦æ±‚å¢åŠ ä¸­å¿ƒç‚¹ï¼Œåˆ™æå–ä¸­å¿ƒç‚¹æ•°èµ‹å€¼ç»™dsd_centerå˜é‡ï¼Œæ²¡æœ‰åˆ™ä¸º0ä¸ªã€‚

          '
        model:
          completion_params:
            seed: 1234
          mode: chat
          name: qwen2.5-32b-instruct
          provider: langgenius/tongyi/tongyi
        parameters:
        - description: å®Œå–„åçš„å®éªŒæè¿°
          name: fine_exp_description
          required: true
          type: string
        - description: dsdå®éªŒè®¾è®¡é¢å¤–å¢åŠ ä¸­å¿ƒç‚¹å®éªŒä¸ªæ•°
          name: dsd_center
          required: true
          type: number
        query:
        - '1744273691090'
        - exp_description
        reasoning_mode: prompt
        selected: false
        title: å®Œå–„å®éªŒæè¿°
        type: parameter-extractor
        variables: []
        vision:
          enabled: false
      height: 134
      id: '1744372089111'
      position:
        x: 631.166534432053
        y: 276.5
      positionAbsolute:
        x: 631.166534432053
        y: 276.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: '>'
            id: 14eb21ef-e4ce-43b5-92aa-0716605330ad
            numberVarType: constant
            value: '0'
            varType: number
            variable_selector:
            - '1744372089111'
            - dsd_center
          id: 'true'
          logical_operator: and
        desc: åˆ¤æ–­æ˜¯å¦ç»™dsdå®éªŒè®¾è®¡é¢å¤–æ·»åŠ ä¸­å¿ƒç‚¹
        selected: false
        title: æ˜¯å¦å¢åŠ ä¸­å¿ƒç‚¹
        type: if-else
      height: 154
      id: '1744373398619'
      position:
        x: 1845
        y: 276.5
      positionAbsolute:
        x: 1845
        y: 276.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import itertools\n\nimport pandas as pd\n\n\ndef add_center_points(dsd,\
          \ factors_dict, n):\n    # ç¡®å®šåˆ†ç±»å˜é‡å’Œè¿ç»­å˜é‡\n    categorical_cols = [col for\
          \ col, levels in factors_dict.items() if isinstance(levels[0], str)]\n \
          \   continuous_cols = [col for col, levels in factors_dict.items() if not\
          \ isinstance(levels[0], str)]\n\n    # è·å–åˆ†ç±»å˜é‡çš„æ‰€æœ‰ç»„åˆ\n    unique_combinations\
          \ = list(itertools.product(*[factors_dict[col] for col in categorical_cols]))\n\
          \    m = len(unique_combinations)\n\n    # è®¡ç®—è¿ç»­å˜é‡çš„ä¸­å¿ƒç‚¹å€¼\n    center_values\
          \ = {col: sum(factors_dict[col]) / len(factors_dict[col]) for col in continuous_cols}\n\
          \n    # ç”Ÿæˆä¸­å¿ƒç‚¹è¡Œ\n    center_points_df = pd.DataFrame([center_values] * (m\
          \ * n))\n\n    # ç”Ÿæˆåˆ†ç±»å˜é‡ç»„åˆçš„DataFrame\n    repeated_categories = pd.DataFrame(\n\
          \        list(itertools.chain.from_iterable(itertools.repeat(combination,\
          \ n) for combination in unique_combinations)),\n        columns=categorical_cols)\n\
          \n    # åˆå¹¶ä¸­å¿ƒç‚¹çš„æ•°å€¼å’Œåˆ†ç±»å˜é‡ç»„åˆ\n    center_points_df = pd.concat([repeated_categories.reset_index(drop=True),\
          \ center_points_df], axis=1)\n\n    # ç»™æ–°æ·»åŠ çš„ä¸­å¿ƒç‚¹è¡Œåˆ†é…æ–°çš„ç´¢å¼•\n    start_idx = dsd.shape[0]\
          \  # ä½¿ç”¨DataFrameçš„é•¿åº¦è€Œä¸æ˜¯ç´¢å¼•æ¥è®¡ç®—èµ·ç‚¹\n    center_points_df.index = range(start_idx,\
          \ start_idx + len(center_points_df))\n\n    # å°†ä¸­å¿ƒç‚¹æ·»åŠ åˆ°åŸå§‹æ•°æ®æ¡†æœ«å°¾\n    df_with_centers\
          \ = pd.concat([dsd, center_points_df], ignore_index=True)  # ä½¿ç”¨ignore_index=Trueæ¥é‡æ–°ç´¢å¼•\n\
          \n    return df_with_centers\n\n\ndef main(factors: object, dsd_result:\
          \ object, n: int) -> dict:\n    dsd_df = pd.DataFrame(dsd_result)\n    result\
          \ = add_center_points(dsd_df, factors, n)\n    result = result.reset_index(drop=True)\
          \  # å…ˆåˆ é™¤åŸç´¢å¼•\n    result.index = result.index + 1  # ç´¢å¼•ä»1å¼€å§‹ï¼ˆå¯¹åº”å®éªŒæ¬¡æ•°ï¼‰\n\n \
          \   # è®¡ç®—å®éªŒæ€»æ¬¡æ•°ï¼ˆæ•°æ®æ¡†çš„è¡Œæ•°ï¼‰\n    experiment_count = len(result)\n\n    return\
          \ {\n        \"result\": result.to_string(),\n        \"exp_count\": experiment_count\n\
          \    }\n"
        code_language: python3
        default_value:
        - key: result
          type: string
          value: æ— æ³•ç”Ÿæˆå®éªŒè®¾è®¡
        - key: exp_count
          type: number
          value: 0
        desc: ''
        error_strategy: default-value
        outputs:
          exp_count:
            children: null
            type: number
          result:
            children: null
            type: string
        selected: false
        title: DSDå¢åŠ ä¸­å¿ƒç‚¹
        type: code
        variables:
        - value_selector:
          - '1744278097895'
          - factors_dict
          variable: factors
        - value_selector:
          - '1744278097895'
          - dsd_result
          variable: dsd_result
        - value_selector:
          - '1744372089111'
          - dsd_center
          variable: n
      height: 90
      id: '1744376522033'
      position:
        x: 2148
        y: 276.5
      positionAbsolute:
        x: 2148
        y: 276.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        instruction: é¦–å…ˆç»Ÿè®¡åˆ†ç±»å˜é‡ä¸ªæ•°ï¼Œè‹¥ä¸ªæ•°åœ¨ä¸¤ä¸ªä»¥ä¸Šåˆ™æå–åˆ†ç±»å˜é‡çš„åç§°å’Œå€¼åˆ°å˜é‡class_xä¸­ï¼ˆåç§°å’Œå€¼ç”¨â€œï¼šâ€éš”å¼€ï¼‰ï¼Œæå–ä¸åŒ…å«åˆ†ç±»å˜é‡çš„å®éªŒè®¾è®¡æè¿°åˆ°å˜é‡exp_descriptionä¸­ã€‚è‹¥ä¸ªæ•°åœ¨ä¸¤ä¸ªä»¥ä¸‹åˆ™å˜é‡class_xèµ‹å€¼ä¸ºâ€œæ— â€ï¼ŒåŸå°ä¸åŠ¨å°†è¾“å…¥èµ‹å€¼ç»™å˜é‡exp_descriptionã€‚
        model:
          completion_params:
            seed: 1234
            temperature: 0.7
          mode: chat
          name: qwen2.5-72b-instruct
          provider: langgenius/tongyi/tongyi
        parameters:
        - description: åˆ†ç±»å˜é‡åç§°å’Œå€¼
          name: class_x
          required: true
          type: string
        - description: å®éªŒè®¾è®¡æè¿°
          name: exp_description
          required: true
          type: string
        query:
        - '1744273691090'
        - exp_description
        reasoning_mode: prompt
        selected: false
        title: åˆ†ç±»å˜é‡å’Œå®éªŒæè¿°æå–
        type: parameter-extractor
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1756553929651'
      position:
        x: 329.6140560570158
        y: 276.5
      positionAbsolute:
        x: 329.6140560570158
        y: 276.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import pandas as pd\nimport numpy as np\nfrom io import StringIO\n\n\
          def main(arg1: str, arg2: str) -> dict:\n    # è§£æarg2ä¸ºDataFrame\n    df\
          \ = pd.read_csv(StringIO(arg2), sep='\\s+')\n    \n    if arg1 == \"æ— \"\
          :\n        result = df\n    else:\n        # è§£æarg1è·å–åˆ†ç±»å˜é‡åå’Œå€¼\n        var_name,\
          \ values_str = arg1.split('ï¼š')\n        values = values_str.split(',')\n\
          \        num_values = len(values)\n        num_rows = len(df)\n        \n\
          \        # è®¡ç®—æ¯ä¸ªå€¼åº”å‡ºç°çš„åŸºç¡€æ¬¡æ•°å’Œå‰©ä½™æ¬¡æ•°\n        base_count = num_rows // num_values\n\
          \        remainder = num_rows % num_values\n        \n        # åˆ›å»ºåˆå§‹åˆ†é…åˆ—è¡¨\n\
          \        assignment = []\n        for i, value in enumerate(values):\n \
          \           # å‰remainderä¸ªå€¼å¤šåˆ†é…ä¸€æ¬¡\n            count = base_count + 1 if i\
          \ < remainder else base_count\n            assignment.extend([value] * count)\n\
          \        \n        # éšæœºæ‰“ä¹±åˆ†é…åˆ—è¡¨\n        np.random.shuffle(assignment)\n \
          \       \n        # æ·»åŠ åˆ°DataFrameä¸­\n        df[var_name] = assignment\n \
          \       result = df\n    \n    return {\n        \"result\": result.to_string(),\n\
          \    }\n"
        code_language: python3
        default_value:
        - key: result
          type: string
          value: æ— æ³•ç”Ÿæˆå®éªŒè®¾è®¡
        desc: ''
        error_strategy: default-value
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: éšæœºåˆ†é…åˆ†ç±»å˜é‡
        type: code
        variables:
        - value_selector:
          - '1756553929651'
          - class_x
          value_type: string
          variable: arg1
        - value_selector:
          - '1744364078889'
          - output
          value_type: string
          variable: arg2
      height: 90
      id: '1756556854361'
      position:
        x: 2834.4547574918115
        y: 351
      positionAbsolute:
        x: 2834.4547574918115
        y: 351
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: -763.9842649189245
      y: 89.42517804569269
      zoom: 0.8499364190765336
