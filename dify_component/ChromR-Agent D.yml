app:
  description: èƒ½å¤Ÿåˆ†æå®éªŒæ•°æ®ï¼Œä½¿ç”¨é€æ­¥å›å½’å»ºæ¨¡ã€‚å¯ä»¥ä¼ å…¥æ–‡ä»¶è®¡ç®—è®¾è®¡ç©ºé—´ã€‚å¯ä»¥è¿›è¡Œå…³è”è§„åˆ™æŒ–æ˜ã€‚å¯ä»¥ä½¿ç”¨è¿›åŒ–ç®—æ³•è¿›è¡Œå¤šç›®æ ‡ä¼˜åŒ–
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: workflow
  name: ChromR-Agent D
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/tongyi:0.0.54@a719a5a226596151af6ff33fa710a74476faa6e1afde9e4a201ff8a7803857ff
kind: app
version: 0.3.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1752050034968-source-1752052345870-target
      selected: false
      source: '1752050034968'
      sourceHandle: source
      target: '1752052345870'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: if-else
      id: 1752065485113-source-1752065530501-target
      selected: false
      source: '1752065485113'
      sourceHandle: source
      target: '1752065530501'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: llm
      id: 1752065530501-true-1752050034968-target
      selected: false
      source: '1752065530501'
      sourceHandle: 'true'
      target: '1752050034968'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: start
        targetType: if-else
      id: 1751875216914-source-1752111647359-target
      selected: false
      source: '1751875216914'
      sourceHandle: source
      target: '1752111647359'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: code
      id: 1752111647359-68ba831b-2f3a-4557-a0c2-49c1b2ae81ad-1751892007118-target
      selected: false
      source: '1752111647359'
      sourceHandle: 68ba831b-2f3a-4557-a0c2-49c1b2ae81ad
      target: '1751892007118'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: llm
      id: 1752111647359-0f9843ae-93f1-4291-af25-7967ff50d5e8-1752065485113-target
      selected: false
      source: '1752111647359'
      sourceHandle: 0f9843ae-93f1-4291-af25-7967ff50d5e8
      target: '1752065485113'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: if-else
        targetType: template-transform
      id: 1752111647359-false-1752116108839-target
      selected: false
      source: '1752111647359'
      sourceHandle: 'false'
      target: '1752116108839'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: code
      id: 1752111647359-true-1751891855571-target
      selected: false
      source: '1752111647359'
      sourceHandle: 'true'
      target: '1751891855571'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: code
      id: 1752111647359-5a95bb08-07e5-4686-b98a-ab1afd1f47f1-1751876027503-target
      selected: false
      source: '1752111647359'
      sourceHandle: 5a95bb08-07e5-4686-b98a-ab1afd1f47f1
      target: '1751876027503'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: variable-aggregator
      id: 1751891855571-source-1752225653044-target
      selected: false
      source: '1751891855571'
      sourceHandle: source
      target: '1752225653044'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: variable-aggregator
      id: 1751892007118-source-1752225653044-target
      selected: false
      source: '1751892007118'
      sourceHandle: source
      target: '1752225653044'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: variable-aggregator
      id: 1751876027503-source-1752225653044-target
      selected: false
      source: '1751876027503'
      sourceHandle: source
      target: '1752225653044'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: variable-aggregator
      id: 1752052345870-source-1752225653044-target
      selected: false
      source: '1752052345870'
      sourceHandle: source
      target: '1752225653044'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: variable-aggregator
      id: 1752065530501-false-1752225653044-target
      selected: false
      source: '1752065530501'
      sourceHandle: 'false'
      target: '1752225653044'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: template-transform
        targetType: variable-aggregator
      id: 1752116108839-source-1752225653044-target
      selected: false
      source: '1752116108839'
      sourceHandle: source
      target: '1752225653044'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: variable-aggregator
        targetType: end
      id: 1752225653044-source-1752225733471-target
      selected: false
      source: '1752225653044'
      sourceHandle: source
      target: '1752225733471'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: å¼€å§‹
        type: start
        variables:
        - allowed_file_extensions: []
          allowed_file_types:
          - image
          allowed_file_upload_methods:
          - local_file
          - remote_url
          label: é€æ­¥å›å½’på€¼
          max_length: 48
          options: []
          required: false
          type: number
          variable: p_value
        - label: å…³è”è§„åˆ™æŒ–æ˜æœ€å°æ”¯æŒåº¦
          max_length: 48
          options: []
          required: false
          type: number
          variable: min_support
        - label: å…³è”è§„åˆ™æŒ–æ˜æœ€å°ç½®ä¿¡åº¦
          max_length: 48
          options: []
          required: false
          type: number
          variable: min_conf
        - label: è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿæ¬¡æ•°
          max_length: 48
          options: []
          required: false
          type: number
          variable: mt
        - label: å¯æ¥å—çš„é£é™©
          max_length: 48
          options: []
          required: false
          type: number
          variable: r
        - label: è®¾è®¡ç©ºé—´ç±»å‹
          max_length: 48
          options:
          - includeN
          - withM
          - withoutM
          - ''
          required: false
          type: text-input
          variable: ds_type
        - allowed_file_extensions: []
          allowed_file_types:
          - document
          allowed_file_upload_methods:
          - local_file
          - remote_url
          label: å¾…åˆ†æçš„æ•°æ®
          max_length: 10
          options: []
          required: false
          type: file-list
          variable: datas
        - label: é€‰æ‹©åŠŸèƒ½
          max_length: 48
          options:
          - é€æ­¥å›å½’
          - å…³è”è§„åˆ™æŒ–æ˜
          - è®¾è®¡ç©ºé—´è®¡ç®—
          - å¤šç›®æ ‡ä¼˜åŒ–
          - å…¶ä»–
          required: true
          type: select
          variable: func
        - label: ç”¨æˆ·éœ€æ±‚æè¿°
          max_length: 10000
          options: []
          required: true
          type: paragraph
          variable: query
        - label: æœåŠ¡å™¨ip
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: server_ip
        - label: æ— æ¦‚ç‡è®¾è®¡ç©ºé—´
          max_length: 48
          options: []
          required: false
          type: number
          variable: no_risk
      height: 350
      id: '1751875216914'
      position:
        x: 28.851301645002962
        y: 348.5
      positionAbsolute:
        x: 28.851301645002962
        y: 348.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "def get_path(filesize):\n    import os\n    # å­˜å‚¨ç¬¦åˆæ¡ä»¶çš„æ–‡ä»¶åˆ—è¡¨\n    matched_files\
          \ = []\n    # æ£€æŸ¥ upload_files æ–‡ä»¶å¤¹\n    upload_dir = '/upload_files'\n\n\
          \    # ç¡®ä¿æ–‡ä»¶å¤¹å­˜åœ¨\n    if not os.path.exists(upload_dir):\n        return {\"\
          file_path\": \"None\"}\n\n    # é€’å½’éå†æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶\n    for root, dirs, files\
          \ in os.walk(upload_dir):\n        for filename in files:  # åªå¤„ç†æ–‡ä»¶ï¼Œå¿½ç•¥æ–‡ä»¶å¤¹\n\
          \            file_path = os.path.join(root, filename)\n\n            # è·å–æ–‡ä»¶çŠ¶æ€ä¿¡æ¯\n\
          \            file_stat = os.stat(file_path)\n\n            # è·å–æ–‡ä»¶ä¿®æ”¹æ—¶é—´\n\
          \            file_mtime = file_stat.st_mtime\n\n            # æ£€æŸ¥æ–‡ä»¶å¤§å°å’Œä¿®æ”¹æ—¶é—´æ˜¯å¦ç¬¦åˆæ¡ä»¶\n\
          \            if file_stat.st_size == filesize:\n                matched_files.append((file_path,\
          \ file_mtime))\n\n    if matched_files:\n        # æŒ‰ä¿®æ”¹æ—¶é—´æ’åºï¼Œå–æœ€æ–°çš„æ–‡ä»¶\n    \
          \    newest_file = max(matched_files, key=lambda x: x[1])\n        return\
          \ str(newest_file[0])\n    else:\n        return \"None\"\n        \ndef\
          \ main(datas, p_value, server_ip):\n    import requests\n\n    pc_size =\
          \ 0\n    er_size = 0\n    mc_size = 0\n    pc_file_name = ''\n    er_file_name\
          \ = ''\n    mc_file_name = ''\n    file_names = ['expresults.xlsx', 'parametercondition.xlsx','materialcondition.xlsx']\n\
          \    for f in datas:\n        if f['filename'].lower() == 'expresults.xlsx':\n\
          \            er_size = f['size']\n            er_file_name = f['filename']\n\
          \            file_names.remove('expresults.xlsx')\n        if f['filename'].lower()\
          \ == 'parametercondition.xlsx':\n            pc_size = f['size']\n     \
          \       pc_file_name = f['filename']\n            file_names.remove('parametercondition.xlsx')\n\
          \        if f['filename'].lower() == 'materialcondition.xlsx':\n       \
          \     mc_size = f['size']\n            mc_file_name = f['filename']\n  \
          \          file_names.remove('materialcondition.xlsx')\n\n    if not (pc_size\
          \ and er_size):\n        error = 'ã€'.join(file_names)\n        return {\"\
          result\": f'æ–‡ä»¶åç§°ä¸å¯¹æˆ–ç¼ºå°‘ï¼Œè¯·ä¸Šä¼ {error}'}\n\n    pc_file_path = get_path(pc_size)\n\
          \    er_file_path = get_path(er_size)\n    mc_file_path = get_path(mc_size)\
          \ if mc_size else None\n\n    api_url = f\"http://{server_ip}:8000/stepwise-regress/\"\
          \n    # å‡†å¤‡æ–‡ä»¶æ•°æ®\n    files = {\n        'pc': (pc_file_name, open(pc_file_path,\
          \ 'rb')),\n        'er': (er_file_name, open(er_file_path, 'rb'))\n    }\n\
          \n    # å¦‚æœæœ‰ç‰©æ–™å±æ€§æ–‡ä»¶ï¼Œæ·»åŠ åˆ°ä¸Šä¼ æ–‡ä»¶ä¸­\n    if mc_size and mc_file_path:\n        files['material']\
          \ = (mc_file_name, open(mc_file_path, 'rb'))\n\n    data = {\n        'p':\
          \ p_value\n    }\n\n    response = requests.post(\n        api_url,\n  \
          \      files=files,\n        data=data\n    )\n\n    if response.status_code\
          \ == 200:\n        response_data = response.json()\n        return {\n \
          \           \"result\": response_data.get(\"result\", \"\")\n        }\n\
          \    else:\n        return {\n            \"result\": f'error: è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç :\
          \ {response.status_code}\\ndetail:{response.text}'\n        }"
        code_language: python3
        default_value:
        - key: result
          type: string
          value: é€æ­¥å›å½’å»ºæ¨¡ä¼ å…¥çš„æ•°æ®æœ‰é—®é¢˜
        desc: ''
        error_strategy: default-value
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: é€æ­¥å›å½’å»ºæ¨¡
        type: code
        variables:
        - value_selector:
          - '1751875216914'
          - p_value
          variable: p_value
        - value_selector:
          - '1751875216914'
          - server_ip
          variable: server_ip
        - value_selector:
          - '1751875216914'
          - datas
          value_type: array[file]
          variable: datas
      height: 90
      id: '1751891855571'
      position:
        x: 636
        y: 334.8554458584045
      positionAbsolute:
        x: 636
        y: 334.8554458584045
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "def get_path(filesize):\n    import os\n    # å­˜å‚¨ç¬¦åˆæ¡ä»¶çš„æ–‡ä»¶åˆ—è¡¨\n    matched_files\
          \ = []\n    # æ£€æŸ¥ upload_files æ–‡ä»¶å¤¹\n    upload_dir = '/upload_files'\n\n\
          \    # ç¡®ä¿æ–‡ä»¶å¤¹å­˜åœ¨\n    if not os.path.exists(upload_dir):\n        return {\"\
          file_path\": \"None\"}\n\n    # é€’å½’éå†æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶\n    for root, dirs, files\
          \ in os.walk(upload_dir):\n        for filename in files:  # åªå¤„ç†æ–‡ä»¶ï¼Œå¿½ç•¥æ–‡ä»¶å¤¹\n\
          \            file_path = os.path.join(root, filename)\n\n            # è·å–æ–‡ä»¶çŠ¶æ€ä¿¡æ¯\n\
          \            file_stat = os.stat(file_path)\n\n            # è·å–æ–‡ä»¶ä¿®æ”¹æ—¶é—´\n\
          \            file_mtime = file_stat.st_mtime\n\n            # æ£€æŸ¥æ–‡ä»¶å¤§å°å’Œä¿®æ”¹æ—¶é—´æ˜¯å¦ç¬¦åˆæ¡ä»¶\n\
          \            if file_stat.st_size == filesize:\n                matched_files.append((file_path,\
          \ file_mtime))\n\n    if matched_files:\n        # æŒ‰ä¿®æ”¹æ—¶é—´æ’åºï¼Œå–æœ€æ–°çš„æ–‡ä»¶\n    \
          \    newest_file = max(matched_files, key=lambda x: x[1])\n        return\
          \ str(newest_file[0])\n    else:\n        return \"None\"\n\ndef main(datas,\
          \ mt, p, r, server_ip, ds_type, no_risk):\n    pc_size = 0\n    er_size\
          \ = 0\n    yl_size = 0\n    xl_size = 0\n    mc_size = 0\n\n    pc_file_name\
          \ = ''\n    er_file_name = ''\n    yl_file_name = ''\n    xl_file_name =\
          \ ''\n    mc_file_name = ''\n\n    # æ ¹æ®ds_typeç¡®å®šéœ€è¦çš„æ–‡ä»¶åˆ—è¡¨\n    if ds_type\
          \ == \"withM\":\n        file_names = ['expresults.xlsx', 'parametercondition.xlsx',\
          \ \"xlimitssteps.xlsx\", 'ylimits.xlsx',\n                      'materialcondition.xlsx']\n\
          \    else:\n        file_names = ['expresults.xlsx', 'parametercondition.xlsx',\
          \ \"xlimitssteps.xlsx\", 'ylimits.xlsx']\n\n    # æå–æ–‡ä»¶ä¿¡æ¯å¹¶éªŒè¯\n    for f in\
          \ datas:\n        lower_name = f['filename'].lower()\n        if lower_name\
          \ == 'expresults.xlsx':\n            er_size = f['size']\n            er_file_name\
          \ = f['filename']\n            file_names.remove('expresults.xlsx')\n  \
          \      elif lower_name == 'parametercondition.xlsx':\n            pc_size\
          \ = f['size']\n            pc_file_name = f['filename']\n            file_names.remove('parametercondition.xlsx')\n\
          \        elif lower_name == 'xlimitssteps.xlsx':\n            xl_size =\
          \ f['size']\n            xl_file_name = f['filename']\n            file_names.remove('xlimitssteps.xlsx')\n\
          \        elif lower_name == 'ylimits.xlsx':\n            yl_size = f['size']\n\
          \            yl_file_name = f['filename']\n            file_names.remove('ylimits.xlsx')\n\
          \        if ds_type == \"withM\" and lower_name == 'materialcondition.xlsx':\n\
          \            mc_size = f['size']\n            mc_file_name = f['filename']\n\
          \            file_names.remove('materialcondition.xlsx')\n\n    # æ£€æŸ¥æ˜¯å¦ç¼ºå°‘æ–‡ä»¶\n\
          \    if ds_type == \"withM\":\n        all_files = pc_size and er_size and\
          \ yl_size and xl_size and mc_size\n    else:\n        all_files = pc_size\
          \ and er_size and yl_size and xl_size\n\n    if not all_files:\n       \
          \ error = 'ã€'.join(file_names)\n        return {\"result\": f'æ–‡ä»¶åç§°ä¸å¯¹æˆ–ç¼ºå°‘ï¼Œè¯·ä¸Šä¼ {error}'}\n\
          \n    # è·å–æ–‡ä»¶è·¯å¾„\n    pc_file = get_path(pc_size)\n    er_file = get_path(er_size)\n\
          \    yl_file = get_path(yl_size)\n    xl_file = get_path(xl_size)\n\n  \
          \  import requests\n    # æ ¹æ®æ˜¯å¦ä¸ºæ— æ¦‚ç‡è®¡ç®—æ„å»ºä¸åŒURL\n    if no_risk:\n        url\
          \ = f\"http://{server_ip}:8000/design-space/noR/{ds_type}\"\n    else:\n\
          \        url = f\"http://{server_ip}:8000/design-space/{ds_type}\"\n\n \
          \   # æ„å»ºæ–‡ä»¶ä¸Šä¼ å­—å…¸\n    files = {\n        'YLimits': (yl_file_name, open(yl_file,\
          \ 'rb')),\n        'ParameterCondition': (pc_file_name, open(pc_file, 'rb')),\n\
          \        'ExpResults': (er_file_name, open(er_file, 'rb')),\n        'XLimitsSteps':\
          \ (xl_file_name, open(xl_file, 'rb'))\n    }\n\n    # å¦‚æœéœ€è¦ç‰©æ–™å±æ€§æ–‡ä»¶åˆ™æ·»åŠ \n  \
          \  if ds_type == \"withM\":\n        mc_file = get_path(mc_size)\n     \
          \   files['MaterialCondition'] = (mc_file_name, open(mc_file, 'rb'))\n\n\
          \    # æ ¹æ®æ˜¯å¦ä¸ºæ— æ¦‚ç‡è®¡ç®—æ„å»ºä¸åŒå‚æ•°\n    if no_risk:\n        payload = {'p': p}\n \
          \   else:\n        payload = {\n            'mt': mt,\n            'r':\
          \ r,\n            'p': p,\n        }\n\n    # å‘é€è¯·æ±‚\n    response = requests.post(url,\
          \ data=payload, files=files)\n\n    # å¤„ç†å“åº”\n    if response.status_code\
          \ == 200:\n        return {\"result\": response.json().get('result')}\n\
          \    else:\n        return {\n            \"result\": f'error: è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç :\
          \ {response.status_code}\\ndetail:{response.text}'\n        }\n"
        code_language: python3
        default_value:
        - key: result
          type: string
          value: è®¾è®¡ç©ºé—´è®¡ç®—ä¼ å…¥æ•°æ®å¼‚å¸¸
        desc: ''
        error_strategy: default-value
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: è®¾è®¡ç©ºé—´è®¡ç®—
        type: code
        variables:
        - value_selector:
          - '1751875216914'
          - mt
          variable: mt
        - value_selector:
          - '1751875216914'
          - p_value
          variable: p
        - value_selector:
          - '1751875216914'
          - r
          variable: r
        - value_selector:
          - '1751875216914'
          - server_ip
          variable: server_ip
        - value_selector:
          - '1751875216914'
          - ds_type
          variable: ds_type
        - value_selector:
          - '1751875216914'
          - datas
          value_type: array[file]
          variable: datas
        - value_selector:
          - '1751875216914'
          - no_risk
          value_type: number
          variable: no_risk
      height: 90
      id: '1751876027503'
      position:
        x: 644.4967880434862
        y: 712.5137030456646
      positionAbsolute:
        x: 644.4967880434862
        y: 712.5137030456646
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "def get_path(filesize):\n    import os\n    # å­˜å‚¨ç¬¦åˆæ¡ä»¶çš„æ–‡ä»¶åˆ—è¡¨\n    matched_files\
          \ = []\n    # æ£€æŸ¥ upload_files æ–‡ä»¶å¤¹\n    upload_dir = '/upload_files'\n\n\
          \    # ç¡®ä¿æ–‡ä»¶å¤¹å­˜åœ¨\n    if not os.path.exists(upload_dir):\n        return {\"\
          file_path\": \"None\"}\n\n    # é€’å½’éå†æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶\n    for root, dirs, files\
          \ in os.walk(upload_dir):\n        for filename in files:  # åªå¤„ç†æ–‡ä»¶ï¼Œå¿½ç•¥æ–‡ä»¶å¤¹\n\
          \            file_path = os.path.join(root, filename)\n\n            # è·å–æ–‡ä»¶çŠ¶æ€ä¿¡æ¯\n\
          \            file_stat = os.stat(file_path)\n\n            # è·å–æ–‡ä»¶ä¿®æ”¹æ—¶é—´\n\
          \            file_mtime = file_stat.st_mtime\n\n            # æ£€æŸ¥æ–‡ä»¶å¤§å°å’Œä¿®æ”¹æ—¶é—´æ˜¯å¦ç¬¦åˆæ¡ä»¶\n\
          \            if file_stat.st_size == filesize:\n                matched_files.append((file_path,\
          \ file_mtime))\n\n    if matched_files:\n        # æŒ‰ä¿®æ”¹æ—¶é—´æ’åºï¼Œå–æœ€æ–°çš„æ–‡ä»¶\n    \
          \    newest_file = max(matched_files, key=lambda x: x[1])\n        return\
          \ str(newest_file[0])\n    else:\n        return \"None\"\n        \ndef\
          \ main(datas, min_support: int, min_conf: float, server_ip: str) -> dict:\n\
          \    import requests\n    url = f\"http://{server_ip}:8000/fp-growth\"\n\
          \    if len(datas) == 0:\n        return {\"result\": \"æ²¡æœ‰ä¸Šä¼ æ•°æ®æ–‡ä»¶\"}\n  \
          \  data_size = datas[0]['size']\n    data_name = datas[0]['filename']\n\
          \    dataset = get_path(data_size)\n    files = {'data_file': (data_name,\
          \ open(dataset, 'rb'))}\n\n    payload = {\n        'min_support': min_support,\n\
          \        'min_conf': min_conf\n    }\n    response = requests.post(url,\
          \ data=payload, files=files)\n\n    if response.status_code == 200:\n  \
          \      return {\"result\": f\"åˆ†ææ–‡ä»¶ï¼š{data_name}\\nå“åº”ç»“æœï¼š{response.json().get('result')}\"\
          }\n    else:\n        return {\n            \"result\": f'error: è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç :\
          \ {response.status_code}\\ndetail:{response.text}'\n        }"
        code_language: python3
        default_value:
        - key: result
          type: string
          value: å…³è”è§„åˆ™æŒ–æ˜ä¼ å…¥çš„æ•°æ®æœ‰é—®é¢˜
        desc: ''
        error_strategy: default-value
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: å…³è”è§„åˆ™æŒ–æ˜
        type: code
        variables:
        - value_selector:
          - '1751875216914'
          - server_ip
          variable: server_ip
        - value_selector:
          - '1751875216914'
          - min_support
          variable: min_support
        - value_selector:
          - '1751875216914'
          - min_conf
          variable: min_conf
        - value_selector:
          - '1751875216914'
          - datas
          value_type: array[file]
          variable: datas
      height: 90
      id: '1751892007118'
      position:
        x: 644.4967880434862
        y: 517.5714285714286
      positionAbsolute:
        x: 644.4967880434862
        y: 517.5714285714286
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            seed: 1234
          mode: chat
          name: qwen-max-latest
          provider: langgenius/tongyi/tongyi
        prompt_template:
        - id: 64d932b8-7efc-4277-8fa9-b3380cb8b560
          role: system
          text: "ä½ çš„ä»»åŠ¡æ˜¯åŸºäºç”¨æˆ·çš„å¤šç›®æ ‡ä¼˜åŒ–ä»»åŠ¡æè¿°ï¼Œæå–å‚æ•°å¹¶ç”Ÿæˆjsonè¯·æ±‚ä½“ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œè¯·å‚è€ƒä»¥ä¸‹pythonå­—å…¸ç¤ºä¾‹ç”ŸæˆåŸºäºç”¨æˆ·æè¿°ä¸”æ»¡è¶³åç«¯è¦æ±‚çš„jsonè¯·æ±‚ä½“ï¼š\n\
            '''â€‹\n{\n        \"variables\": {\n            \"x\": {\"lower\": 0, \"\
            upper\": 5},\n            \"y\": {\"lower\": 0, \"upper\": 5}\n      \
            \  },\n        \"objective_functions\": {\n            \"objective1\"\
            : textwrap.dedent(inspect.getsource(å‡½æ•°ä½“)),\n            \"objective2\"\
            : textwrap.dedent(inspect.getsource(å‡½æ•°ä½“)),\n            \"constraint\"\
            : textwrap.dedent(inspect.getsource(å‡½æ•°ä½“))\n        },\n        \"objective_ranges\"\
            : {\n            \"objective1\": {\"min_value\": None, \"max_value\":\
            \ None, \"direction\": \"min\"},\n            \"objective2\": {\"min_value\"\
            : None, \"max_value\": None, \"direction\": \"max\"},\n            \"\
            constraint\": {\"min_value\": 5, \"max_value\": None, \"direction\": None}\
            \  # çº¯çº¦æŸæ¡ä»¶\n        },\n        \"algorithm\": \"nsga3\",\n        \"\
            population_size\": 100,\n        \"generations\": 100\n}\n'''\n\n#ç”Ÿæˆjsonè¯·æ±‚ä½“è¦ç‚¹ï¼š\n\
            1. variableså­—æ®µé‡Œçš„å˜é‡åç§°ä¸€å®šè¦ä¸objective_functionsä¼ å…¥å‚æ•°çš„åç§°å®Œå…¨ä¸€è‡´\n2. objective_functionså­—æ®µçš„å‡½æ•°åç§°å’Œç›®æ ‡å€¼åç§°ä¸€å®šè¦ä¸objective_rangeså­—æ®µçš„ç›®æ ‡å€¼èŒƒå›´åç§°å®Œå…¨ä¸€è‡´\n\
            3. objective_functionså­—æ®µçš„å‡½æ•°å­—ç¬¦ä¸²ä¸€å®šè¦ä¸textwrap.dedent(inspect.getsource(objective1))ä»£ç ç”Ÿæˆå½¢å¼ä¸€è‡´\n\
            4. algorithmå­—æ®µä¸æ˜¯å¿…å¡«ï¼Œåç«¯é»˜è®¤â€œnsga2â€ï¼Œä¸”åªå¯é€‰â€œnsga2â€å’Œâ€œnsga3â€ã€‚è‹¥ç”¨æˆ·æœªæŒ‡å®šåˆ™æ ¹æ®ç”¨æˆ·ä¼˜åŒ–ç›®æ ‡æ•°é‡é€‰æ‹©ã€‚â€œnsga2â€é€‚åˆ2-3\
            \ ä¸ªç›®æ ‡ï¼Œâ€œnsga3â€é€‚åˆ4 ä¸ªåŠä»¥ä¸Šç›®æ ‡ã€‚\n5. generationsè‹¥ç”¨æˆ·æœªæŒ‡å®šåˆ™é»˜è®¤100ã€‚è‹¥ç”¨æˆ·æœªæŒ‡å®špopulation_sizeåˆ™é»˜è®¤100ã€‚\n\
            6. æ³¨æ„jsonè¯·æ±‚ä½“ç©ºå€¼æ˜¯nullè€Œä¸æ˜¯None\n7. æ¯ä¸ªobjective_functionsä¼ å…¥å‚æ•°éƒ½è¦åŒ…å«æ‰€æœ‰variableså­—æ®µé‡Œçš„å˜é‡ï¼Œå³ä½¿æœ‰äº›å‚æ•°å¹¶æ²¡æœ‰ä½¿ç”¨åˆ°\n\
            \n\nåªè¿”å›ç”Ÿæˆçš„jsonè¯·æ±‚ä½“ï¼Œä¸ä½¿ç”¨ä»£ç å—åŒ…è£¹ï¼ä¸è¦è¿”å›ç”¨æˆ·æè¿°ä¸­æ²¡æœ‰æåˆ°çš„å†…å®¹"
        - id: 8bf2aa5e-4a5f-425f-ad72-0a4b021a50ae
          role: user
          text: 'ç”¨æˆ·æè¿°å¦‚ä¸‹ï¼š

            {{#1751875216914.query#}}'
        selected: false
        title: å¤šç›®æ ‡ä¼˜åŒ–jsonç”Ÿæˆ
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1752050034968'
      position:
        x: 916.9937382926614
        y: 902
      positionAbsolute:
        x: 916.9937382926614
        y: 902
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        author: tzl
        desc: ''
        height: 205
        selected: false
        showAuthor: true
        text: '{"root":{"children":[{"children":[{"detail":0,"format":1,"mode":"normal","style":"font-size:
          14px;","text":"å¤šç›®æ ‡ä¼˜åŒ–æµ‹è¯•æç¤ºè¯ï¼š","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":1,"textStyle":"font-size:
          14px;"},{"children":[],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":1,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"font-size:
          12px;","text":"ç›®æ ‡1è®¡ç®—å…¬å¼","type":"text","version":1},{"detail":0,"format":0,"mode":"normal","style":"","text":"(x
          - 3) ** 2 + (y - 2) ** 2","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textStyle":"font-size:
          12px;","textFormat":0},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"ç›®æ ‡2è®¡ç®—å…¬å¼-(x
          - 1) ** 2 - (y - 4) ** 2+60","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"å˜é‡xå’Œyçš„èŒƒå›´éƒ½æ˜¯0-5ï¼Œè¿›è¡Œå¤šç›®æ ‡ä¼˜åŒ–ï¼Œè¦æ±‚x+yå¤§äº5ï¼Œç›®æ ‡1æœ€å°ï¼Œç›®æ ‡2æœ€å¤§","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""}],"direction":"ltr","format":"","indent":0,"type":"root","version":1}}'
        theme: blue
        title: ''
        type: ''
        width: 347
      height: 205
      id: '1752051742845'
      position:
        x: 159.5341009290516
        y: 792.0272026104942
      positionAbsolute:
        x: 159.5341009290516
        y: 792.0272026104942
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom-note
      width: 347
    - data:
        code: "\ndef main(request_data: str, server_ip: str) -> dict:\n    import\
          \ json\n    import requests\n    request_data = json.loads(request_data)\n\
          \    response = requests.post(\n        f\"http://{server_ip}:8000/optimize/\"\
          ,\n        json=request_data\n    )\n    if response.status_code == 200:\n\
          \        response_data = response.json()\n        return {\n           \
          \ \"result\": response_data.get(\"result\", \"\")\n        }\n    else:\n\
          \        return {\n            \"result\": f\"è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : {response.status_code}\\\
          nå…·ä½“ä¿¡æ¯{response.text}\"\n        }\n"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: å¤šç›®æ ‡ä¼˜åŒ–è¯·æ±‚
        type: code
        variables:
        - value_selector:
          - '1752050034968'
          - text
          variable: request_data
        - value_selector:
          - '1751875216914'
          - server_ip
          variable: server_ip
      height: 54
      id: '1752052345870'
      position:
        x: 1257.857142857143
        y: 930.5714285714287
      positionAbsolute:
        x: 1257.857142857143
        y: 930.5714285714287
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            seed: 1234
          mode: chat
          name: qwen-max-latest
          provider: langgenius/tongyi/tongyi
        prompt_template:
        - id: f605d18e-66eb-4c34-b14f-3dd4ffefa1b5
          role: system
          text: 'ä½ çš„ä»»åŠ¡æ˜¯æ ¹æ®åç«¯pydanticæ¨¡å‹åˆ¤æ–­ç”¨æˆ·æè¿°å†…å®¹æ˜¯å¦å®Œæ•´ï¼Œæ˜¯å¦å¯ä»¥ä»æè¿°ä¸­æå–æ‰€æœ‰å¿…å¡«çš„å‚æ•°ä»¥ç”Ÿæˆjsonè¯·æ±‚ä½“ã€‚ç¼ºå°‘åç«¯é»˜è®¤å‚æ•°ä¸è§†ä¸ºä¸å®Œæ•´ã€‚

            è‹¥å®Œæ•´åˆ™åªè¾“å‡ºâ€œå®Œæ•´â€ï¼Œä¸è¦è¿”å›é¢å¤–çš„æ–‡å­—

            è‹¥ä¸å®Œæ•´ï¼Œåˆ™å‘Šè¯‰ç”¨æˆ·å¿…é¡»ç»™å‡ºçš„ä¿¡æ¯ï¼ˆå¿…å¡«å­—æ®µï¼‰ï¼ŒæŒ‰ä»¥ä¸‹æ ¼å¼è¾“å‡ºï¼š

            â€˜â€™â€˜

            ç¼ºå°‘éƒ¨åˆ†ä¿¡æ¯ï¼Œè¯·æä¾›ï¼š

            1. ä¿¡æ¯1

            2. ä¿¡æ¯2

            3. ...

            â€™â€˜â€™


            åç«¯æœ‰é»˜è®¤å‚æ•°çš„å­—æ®µåŒ…æ‹¬â€œalgorithmâ€ã€â€œpopulation_sizeâ€å’Œâ€œgenerationsâ€

            å¿…é¡»è¦æä¾›çš„æœ‰å„ä¸ªè‡ªå˜é‡çš„èŒƒå›´ã€å„ä¸ªç›®æ ‡çš„è®¡ç®—å…¬å¼ã€å„ä¸ªç›®æ ‡çš„ä¼˜åŒ–æ–¹å‘ï¼ˆæœ€å¤§æˆ–è€…æœ€å°ï¼‰æˆ–è€…çº¦æŸï¼ˆæŒ‡å®šèŒƒå›´ï¼‰


            æ³¨æ„ï¼šä¼˜åŒ–æ–¹å‘å’Œçº¦æŸè‡³å°‘è¦æœ‰ä¸€ä¸ªï¼Œä½†ä¸è¦æ±‚éƒ½æœ‰'
        - id: a2f1e9ee-9899-4314-8f3d-dc36c074d588
          role: user
          text: "ç”¨æˆ·æè¿°å¦‚ä¸‹ï¼š\n{{#1751875216914.query#}}\n\nåç«¯pydanticæ¨¡å‹å¦‚ä¸‹ï¼š\nclass VariableRange(BaseModel):\n\
            \    lower: float\n    upper: float\n\n    @field_validator('lower', 'upper')\n\
            \    def check_bounds(cls, v):\n        if not isinstance(v, (int, float)):\n\
            \            raise ValueError(\"è¾¹ç•Œå€¼å¿…é¡»æ˜¯æ•°å­—\")\n        return float(v)\n\
            \n\nclass ObjectiveDirection(str, Enum):\n    MAX = \"max\"\n    MIN =\
            \ \"min\"\n\n\nclass OptimizationAlgorithm(str, Enum):\n    NSGA2 = \"\
            nsga2\"\n    NSGA3 = \"nsga3\"\n\n\nclass ObjectiveRange(BaseModel):\n\
            \    min_value: Optional[float] = None\n    max_value: Optional[float]\
            \ = None\n    direction: Optional[ObjectiveDirection] = None\n\n    @field_validator('min_value',\
            \ 'max_value')\n    def check_values(cls, value, field_info):\n      \
            \  if field_info.field_name == 'min_value':\n            max_value = field_info.data.get('max_value')\n\
            \            if max_value is not None and value is not None and value\
            \ > max_value:\n                raise ValueError(\"min_valueä¸èƒ½å¤§äºmax_value\"\
            )\n        return value\n\n\nclass OptimizationRequest(BaseModel):\n \
            \   variables: Dict[str, VariableRange]\n    objective_functions: Dict[str,\
            \ str]\n    objective_ranges: Dict[str, ObjectiveRange]\n    algorithm:\
            \ OptimizationAlgorithm = OptimizationAlgorithm.NSGA2\n    population_size:\
            \ int = Field(500, gt=0)\n    generations: int = Field(100, gt=0)\n\n\
            \    @field_validator('objective_ranges')\n    def check_objective_ranges(cls,\
            \ value):\n        for name, obj_range in value.items():\n           \
            \ if obj_range.direction is None and obj_range.min_value is None and obj_range.max_value\
            \ is None:\n                raise ValueError(f\"ç›®æ ‡ {name} å¿…é¡»æŒ‡å®šdirectionæˆ–è¾¹ç•Œçº¦æŸ\"\
            )\n        return value\n\n    @field_validator('objective_ranges')\n\
            \    def check_at_least_one_direction(cls, value):\n        if all(obj_range.direction\
            \ is None for obj_range in value.values()):\n            raise ValueError(\"\
            è‡³å°‘éœ€è¦æŒ‡å®šä¸€ä¸ªç›®æ ‡çš„æ–¹å‘ï¼ˆmaxæˆ–minï¼‰\")\n        return value"
        selected: false
        title: æè¿°å®Œæ•´æ£€æŸ¥
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1752065485113'
      position:
        x: 621.3860517853404
        y: 902
      positionAbsolute:
        x: 621.3860517853404
        y: 902
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: contains
            id: 3d13f52e-c9d7-4c78-a2cc-f94344a15619
            value: å®Œæ•´
            varType: string
            variable_selector:
            - '1752065485113'
            - text
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: åˆ¤æ–­å®Œæ•´
        type: if-else
      height: 126
      id: '1752065530501'
      position:
        x: 924.7142857142856
        y: 758.2857142857142
      positionAbsolute:
        x: 924.7142857142856
        y: 758.2857142857142
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: contains
            id: 0590a706-2ff6-4aac-b4b3-b7044a5e0ba7
            value: é€æ­¥å›å½’
            varType: string
            variable_selector:
            - '1751875216914'
            - func
          id: 'true'
          logical_operator: or
        - case_id: 68ba831b-2f3a-4557-a0c2-49c1b2ae81ad
          conditions:
          - comparison_operator: contains
            id: 1627b734-0d3b-4477-b1af-9f7e86face6a
            value: å…³è”è§„åˆ™
            varType: string
            variable_selector:
            - '1751875216914'
            - func
          id: 68ba831b-2f3a-4557-a0c2-49c1b2ae81ad
          logical_operator: and
        - case_id: 5a95bb08-07e5-4686-b98a-ab1afd1f47f1
          conditions:
          - comparison_operator: contains
            id: b74208be-e8e3-4a1c-9134-9ed7ab4f1431
            value: è®¾è®¡ç©ºé—´
            varType: string
            variable_selector:
            - '1751875216914'
            - func
          id: 5a95bb08-07e5-4686-b98a-ab1afd1f47f1
          logical_operator: and
        - case_id: 0f9843ae-93f1-4291-af25-7967ff50d5e8
          conditions:
          - comparison_operator: contains
            id: bf41c1e0-2756-4463-8908-91d474d67024
            value: å¤šç›®æ ‡ä¼˜åŒ–
            varType: string
            variable_selector:
            - '1751875216914'
            - func
          id: 0f9843ae-93f1-4291-af25-7967ff50d5e8
          logical_operator: and
        desc: ''
        selected: false
        title: åŠŸèƒ½åˆ¤æ–­
        type: if-else
      height: 270
      id: '1752111647359'
      position:
        x: 333
        y: 348.5
      positionAbsolute:
        x: 333
        y: 348.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        selected: false
        template: "å½“å‰æ¨¡å—æ²¡æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š\r\n{{ arg1 }}"
        title: æ— è¯¥åŠŸèƒ½
        type: template-transform
        variables:
        - value_selector:
          - '1751875216914'
          - func
          variable: arg1
      height: 54
      id: '1752116108839'
      position:
        x: 636
        y: 1067
      positionAbsolute:
        x: 636
        y: 1067
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        output_type: string
        selected: false
        title: å˜é‡èšåˆå™¨
        type: variable-aggregator
        variables:
        - - '1752052345870'
          - result
        - - '1751892007118'
          - result
        - - '1751876027503'
          - result
        - - '1752116108839'
          - output
        - - '1751891855571'
          - result
        - - '1752065485113'
          - text
      height: 218
      id: '1752225653044'
      position:
        x: 1930.2384463248206
        y: 921.0145857372185
      positionAbsolute:
        x: 1930.2384463248206
        y: 921.0145857372185
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1752225653044'
          - output
          value_type: string
          variable: result
        selected: false
        title: ç»“æŸ
        type: end
      height: 90
      id: '1752225733471'
      position:
        x: 2248.606649301933
        y: 979.9101153563386
      positionAbsolute:
        x: 2248.606649301933
        y: 979.9101153563386
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: -35.70144540693127
      y: -395.56475432784237
      zoom: 1.0367394549115287
